---
title: GAN Tutorial - How do GANs work?
layout: post
mathjax: true
---

[制作中]
我们已经了解了GAN与其他生成模型的区别，下面我们将学习GAN是如何工作的。

## 3.1 GAN framework

GAN的基本思想是两个玩家共同玩一个游戏。 其中一个叫生成器。 生成器根据训练数据的分布来生成样本。 另一个玩家是判别器。 判别器用来判别样本的真伪。
判别器使用传统的监督学习的方法，将输入分类为真和假两个类。 生成器被优化来试图欺骗判别器。
举个例子来说， 生成器类似于假币制造者，他试图制作假币， 判别器类似于警察， 他试图判别真币和假币。 
为了在游戏中取得成功， 造假者必须学习制造能够以假乱真的假币， 并且生成器必须学习生成与训练数据有同样分布的样本。
图12展示了这个过程。

![Figure 12](/images/201705/03/fig12.jpg)

图12： GAN设计为两个对抗着在同一个游戏中互相对抗。 每一个玩家被描述了由一组参数组成的可微函数。 通常情况下，这些函数使用DNN。
这个游戏可以被展开为两个场景。 第一个， 随机的从训练数据集从采样$$x$$,并被用于判别器$$D$$的输入。 判别器的目标是输出样本是真非假的概率， 此判决的前提是一半的输入是真的，另一半是伪样本。 在此第一个场景中， 判别器的目标是让$$D(x)$$趋近于1.
第二个场景， 生成器的输入$$z$$是根据模型隐变量先验的随机采样。 然后，生成器生成的伪样本$$G(z)$$被输入判别器。 在这个场景中， 两个玩家都在参与。 判别器试图让$$D(G(z))$$趋近0， 生成器试图让其趋近1. 如果两个模型具备足够的能力，那么最终游戏将达到纳什均衡， 也就是$$G(z)$$的生成样本将满足训练数据分布， 并且对所有的$$x$$, $$D(x)=1/2$$.

形式上， GAN是结构化概率模型包含隐变量$$z$$以及观测变量$$x$$. （参考Goodfellow et al, (2016) 第16章关于结构化概率模型的介绍） 图13展示了图结构。

![Figure 13](/images/201705/03/fig13.jpg)

图13： GAN的图形化模型结构， 类似于VAEs， sparse coding, 等等。 它是一种直接的图像化模型也就是每一个隐变量影响每一个观测变量。 有些GAN变种去除了一些链接。

两个玩家被描述为两个函数， 每一个对输入和参数都是可微的。 判别器是函数$$D$$， 输入是$$x$$, 参数$$\theta^{(D)}$$。 生成器被定义为函数$$G$$, 输入$$z$$, 参数$$\theta^{(G)}$$。

两个玩家的损失函数都对应着各自的参数。 判别器希望最小化 $$J^{(D)}(\theta^{(D)},\theta^{(G)})$$但是只能通过对$$\theta^{(D)}$$的控制完成。 同样的生成器希望最小化$$J^{(D)}(\theta^{(D)},\theta^{(G)})$$但是只能通过对$$\theta^{(G)}$$的控制完成。
两个玩家的损失函数都受另一个玩家的参数影响， 但是却不能控制对方的参数， 这个场景像是一个游戏而不是一个优化问题。
此优化问题的解是一个（局部）最小化问题， 也就是一个参数空间的点其近旁的点都有比其大或者相等的损失。
这是游戏的纳什均衡。 这里我们使用术语局部微分纳什均衡(Ratliff et al., 2013)。
纳什均衡是一个元组$$(\theta^{(D)},\theta^{(G)})$$， 对参数$$\theta^{(D)}$$局部最小化$$J^{(D)}$$， 对参数$$\theta^{(G)}$$局部最小化$$J^{(G)}$$.

**生成器** 生成器是一个简单的可微函数$$G$$。 $$z$$根据一个简单的先验分布来采样， $$G(z)$$根据$$p_{model}$$生成样本$$x$$。
通常， G使用DNN模型。 

## 3.2 损失函数

### 3.2.1 判别器损失函数

![Equation 8](/images/201705/03/eq08.jpg)

![Equation 9](/images/201705/03/eq09.jpg)

### 3.2.2 Minimax 最小最大化

![Equation 10](/images/201705/03/eq10.jpg)

![Equation 11](/images/201705/03/eq11.jpg)

![Equation 12](/images/201705/03/eq12.jpg)


### 3.2.3 启发式， 非饱和游戏

![Equation 13](/images/201705/03/eq13.jpg)

### 3.2.4 最大似然游戏

![Equation 14](/images/201705/03/eq14.jpg)

### 3.2.5 

![Figure 14](/images/201705/03/fig14.jpg)

### 3.2.6 损失函数比较

## 3.3 DCGAN结构

## 3.4 



